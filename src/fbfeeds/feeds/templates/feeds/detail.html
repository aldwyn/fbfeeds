<!DOCTYPE html>
<html lang="en">
{% include 'static/head.html' %}

<body>
	{% include 'static/header.html' %}

	<div class="container std-container">
		<h3>
			<span class="glyphicon glyphicon-bullhorn" aria-hidden="true"></span>
			<a href="{% url 'feeds:profile' post.author.user.username %}">@{{ post.author.user.username }}</a> shouted out:
		</h3>
		<div class="pull-right user-buttons">
			<div class="btn-group" role="group">
			{% if has_liked %}
				<a class="btn btn-success" href="{% url 'feeds:unlike' post.id %}">
					<span class="glyphicon glyphicon-heart" aria-hidden="true"></span>
				</a>
			{% else %}
				<a class="btn btn-primary" href="{% url 'feeds:like' post.id %}">
					<span class="glyphicon glyphicon-heart" aria-hidden="true"></span>
				</a>
			{% endif %}
			{% if post.author.user.pk == session_user.user.pk %}
				<button type="button" class="btn btn-warning" data-toggle="modal" data-target=".edit-post">
					<span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
				</button>
				<button type="button" class="btn btn-danger" data-toggle="modal" data-target=".delete-post">
					<span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
				</button>
			{% endif %}
			{% if likers_count > 0 %}
				<button type="button" class="btn btn-primary" data-toggle="modal" data-target=".show-likers">
					Likers <span class="badge">{{ likers_count }}</span>
				</button>
			{% endif %}
			</div>
			<div class="modal fade edit-post" tabindex="-1" role="dialog" aria-hidden="true">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
							<h4 class="modal-title" id="myModalLabel">Edit post</h4>
						</div>
						<form action="{% url 'feeds:edit_post' post.id %}" method="post">
						{% csrf_token %}
							<div class="modal-body">
								<div class="form-group">
									<textarea name="content" rows="4" class="form-control">{{ post.content }}</textarea>
								</div>
							</div>
							<div class="modal-footer">
								<button type="submit" class="btn btn-primary">Save changes</button>
							</div>
						</form>
					</div>
				</div>
			</div>
			<div class="modal fade delete-post" tabindex="-1" role="dialog" aria-hidden="true">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
							<h4 class="modal-title" id="myModalLabel">Are you sure you really want to delete this post?</h4>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
							<a href="{% url 'feeds:delete_post' post.id %}" class="btn btn-danger">Delete</a>
						</div>
					</div>
				</div>
			</div>
			<div class="modal fade show-likers" tabindex="-1" role="dialog" aria-hidden="true">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
							<h4 class="modal-title" id="myModalLabel">Likers of this post</h4>
						</div>
						<div class="modal-body">
							<ul class="list-group">
							{% for like in likes %}
								<li class="list-group-item">
									<span class="glyphicon glyphicon-user" aria-hidden="true"></span>
									<a href="{% url 'feeds:profile' like.liker.user.username %}">@{{ like.liker.user.username }}</a>
								</li>
							{% endfor %}
							</ul>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
						</div>
					</div>
				</div>
			</div>
		</div>
		<blockquote class="well">
			<p><em>{{ post.content|linebreaks }}</em></p>
			<footer>on <em>{{ post.post_date }}</em></footer>
		</blockquote>
		<div class="well">
			<ul class="list-group">
				{% for comment in comments %}
					<li class="list-group-item">
						<span class="glyphicon glyphicon-comment" aria-hidden="true"></span>
						<a href="{% url 'feeds:profile' comment.author.user.username %}">@{{ comment.author }}</a>: 
						<em>{{ comment.content }}</em>
					</li>
				{% empty %}
					<p>Be the first to comment!</p>
				{% endfor %}
				<li class="list-group-item">
					<form action="{% url 'feeds:comment' %}" method="post" class="form-inline">
					{% csrf_token %}
						{{ comment_form.post }}
						{{ comment_form.author }}
						{{ comment_form.content }}
						<button type="submit" class="btn btn-primary btn-sm" style="margin-left: 4px">
							<span class="glyphicon glyphicon-bullhorn" aria-hidden="true"></span> Comment
						</button>
					</form>
				</li>
			</ul>
		</div>
	</div>


	{% include 'static/footer.html' %}
</body>

{% include 'static/scripts.html' %}